import csv
import re
import sys

banner =  sys.argv[1] # getting banner from php

def read_descriptions_from_csv(csv_filename, banner):
    descriptions = []
    
    # Read the CSV file and create a list of descriptions containing the banner keyword
    with open(csv_filename, 'r', encoding='utf-8') as csv_file:
        csv_reader = csv.reader(csv_file)
        for row in csv_reader:
            if len(row) >= 3:
                description = row[2]
                if banner.lower() in description.lower():
                    descriptions.append(description)

    return descriptions

def compare_banner_to_descriptions(banner, descriptions):
    if descriptions:
        print(f"Banner '{banner}' closely matches description(s):")
        for description in descriptions:
            print(f"- '{description}'")
    else:
        print(f"No close match found for banner '{banner}'")

# Example CSV filename
csv_filename = 'exploitdb_csv.csv'  # Assuming the CSV file is named exploitdb_csv.csv

# Example banner
banner = 'PHP Blue Dragon CMS 2.9.1'  # Replace with your banner

# Read descriptions from CSV based on the banner keyword
descriptions = read_descriptions_from_csv(csv_filename, banner)

# Compare banner to descriptions
compare_banner_to_descriptions(banner, descriptions)
