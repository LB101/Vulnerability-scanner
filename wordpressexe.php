<?php
session_start(); // Start the session

// Check if the user is logged in
error_reporting(0);
$_SESSION['isLoggedIn'];
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Modem Website</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">

    <style>
     

        

        nav {
           
            padding: 10px;
            text-align: center;
        }

        nav a {
            color: white;
            text-decoration: none;
            padding: 14px 16px;
            display: inline-block;
        }

        nav a:hover {
            
            color: rgb(255, 251, 0);
        }

        section {
            padding: 20px;
        }

        footer {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 10px;
            position: fixed;
            bottom: 0;
            width: 100%;
        }

        body {
            font-family: 'Roboto', sans-serif;
            color: #f2f2f2;
            /* Set background image */
            background-image: url('background.png');
            
            /* Set background size to cover the entire viewport */
            background-size: cover;

            /* Set background repeat to no-repeat */
            background-repeat: no-repeat;

            /* Set background position to center center */
            background-position: center center;

            /* Set minimum height to cover the entire viewport */
            min-height: 100vh;

            /* Optional: Add additional styles like background color */
            /* background-color: #f0f0f0; */
            
            /* Optional: Add styles to the content for better readability */
            /* color: #333; */
            /* font-family: Arial, sans-serif; */
            /* other styles... */

        }

        .login {

    background-color: #3498db; /* Blue background color */
    color: white;
    text-decoration: none;
    padding: 12px 18px; /* Adjust padding as needed */
    display: inline-block;
    border-radius: 5px; /* Rounded edges */
    margin-left: 1%;

        }


        .reg{
            border: 2px solid white; 
    border-radius: 10px;
    padding: 10px 16px; /* Adjust padding as needed */
    display: inline-block;

        }


        input[type=text], select {
  width: 100%;
  padding: 12px 20px;
  margin: 8px 0;
  display: inline-block;
  border: 1px solid #ccc;
  border-radius: 4px;
  box-sizing: border-box;
}

input[type=submit] {
  width: 100%;
  background-color: #3498db;
  color: white;
  padding: 14px 20px;
  margin: 8px 0;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

input[type=submit]:hover {
    color: rgb(255, 251, 0);
}

div {
  border-radius: 5px;
  /* background-color: #f2f2f2; */
  
  width: 50%;
  position: absolute;
  
  left: 25%;


}

.info{

    position:relative; top:120px;
}


    </style>
</head>
<body >

    <header>
        
        <nav>
            
            <a href="index.html">Home</a>
            <a href="#about">About</a>
            <a href="#services">Services</a>
            <a href="#contact">Contact</a>

            <?php if (!$_SESSION['isLoggedIn']): ?>
                <a href="login.html" style="float: right" class="login">Login</a>
            <a href="register.html" class="reg" style="float: right">Register</a>
<?php endif; ?>
            
        </nav>
        
    </header>

    <section>


    <?php
// $output = shell_exec('python3 domain.py 2>&1');
// echo "<pre>$output</pre>";
session_start();
if(!$_SESSION['isLoggedIn']){

    echo "Please sign in/register first before using this feature";
}

elseif(!empty($_POST['domain'])) {

$phpValue = $_POST['domain'];

$output = shell_exec("python3 domain.py " . escapeshellarg($phpValue) . " 2>&1");
echo "<pre>$output</pre>";
}

elseif(!empty($_POST['service'])) {

    ////

    $banner = $_POST["service"];
    
    function read_descriptions_from_csv($csv_filename, $banner) {
        $descriptions = [];
        
        // Read the CSV file and create a list of descriptions containing the banner keyword
        if (($handle = fopen($csv_filename, "r")) !== FALSE) {
            while (($row = fgetcsv($handle, 1000, ",")) !== FALSE) {
                if (count($row) >= 3) {
                    $description = $row[2];
                    if (stripos($description, $banner) !== false) {
                        $descriptions[] = $description;
                    }
                }
            }
            fclose($handle);
        }
    
        return $descriptions;
    }
    
    function compare_banner_to_descriptions($banner, $descriptions) {
        if (!empty($descriptions)) {
            echo "Banner '{$banner}' closely matches description(s):" . PHP_EOL;
            foreach ($descriptions as $description) {
                echo "- '{$description}'" . PHP_EOL;
            }
        } else {
            echo "No close match found for banner '{$banner}'" . PHP_EOL;
        }
    }
    
    // Example CSV filename
    $csv_filename = 'exploitdb_csv.csv';  // Assuming the CSV file is named exploitdb_csv.csv
    
    // Example banner
    
    // $banner = 'PHP Blue Dragon CMS 2.9.1';  
    
    // Read descriptions from CSV based on the banner keyword
    $descriptions = read_descriptions_from_csv($csv_filename, $banner);
    
    // Compare banner to descriptions
    compare_banner_to_descriptions($banner, $descriptions);
    
    /////
    }

elseif(!empty($_POST['wordpress'])) {

    $phpValue = $_POST['wordpress'];
    
    $output = shell_exec("python3 wordpress.py " . escapeshellarg($phpValue) . " 2>&1");
    echo "<pre>$output</pre>";
    }

elseif(!empty($_POST['fuzzer'])) {

    $phpValue = $_POST['fuzzer'];
        
    $output = shell_exec("python3 fuzzer.py " . escapeshellarg($phpValue) . " 2>&1");
       
    echo "<pre>$output</pre>";
    }

elseif(!empty($_POST['sql'])) {

    $phpValue = $_POST['sql'];
            
    $output = shell_exec("python3 sqlscanner.py " . escapeshellarg($phpValue) . " 2>&1");
           
    echo "<pre>$output</pre>";
    }

        

    

////////////////////////////////////////
?>
    </section>

 

    
    
    <footer>
        &copy; 2024 Your Modem Website. All rights reserved.
    </footer>

</body>
</html>
