<?php
session_start();
error_reporting(0);

// Check if the session variable is set and not empty
if ($_SESSION['sms'] == $_POST['sms']) {
    

    include "conndb.php";
    
    // Handle registration form submission
    if ($_SERVER["REQUEST_METHOD"] == "POST") {
        // Retrieve user inputs
        $firstname = mysqli_real_escape_string($conn, $_SESSION['firstname']);
        $lastname = mysqli_real_escape_string($conn, $_SESSION['lastname']);
        $email = mysqli_real_escape_string($conn, $_SESSION['email']);
        $phone = mysqli_real_escape_string($conn, $_SESSION['phone']);
        $password = password_hash($_SESSION['password'], PASSWORD_DEFAULT); // Hash the password
    
        // Check if the email is already in use
        $checkEmailQuery = "SELECT id FROM users WHERE email = '$email'";
        $result = mysqli_query($conn, $checkEmailQuery);
    
        if (mysqli_num_rows($result) > 0) {
            // Email already in use
           
            $message = "Error: Email is already in use.";
        } else {
            // Insert user data into the database
            $insertQuery = "INSERT INTO users (firstname, lastname, email, phone,password) VALUES ('$firstname', '$lastname', '$email',  '$phone','$password')";
    
            if (mysqli_query($conn, $insertQuery)) {
                header("Location: success.php?mes=Registration successful User data stored in the database");
            } else {
                echo "Error: " . $insertQuery . "<br>" . mysqli_error($conn);
            }
        }
    
        // Free the result set
        mysqli_free_result($result);
    }
    
    // Close the database connection
    mysqli_close($conn);
    


} else {
    
    $message = "Wong code entered. Please try again";
}
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vulnerability Scanner</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
    <link rel="icon" type="image/x-icon" href="logo.svg">
    <style>
     

        

        nav {
           
            padding: 10px;
            text-align: center;
        }

        nav a {
            color: white;
            text-decoration: none;
            padding: 14px 16px;
            display: inline-block;
        }

        nav a:hover {
            
            color: rgb(255, 251, 0);
        }

        section {
            padding: 20px;
        }

        footer {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 10px;
            position: fixed;
            bottom: 0;
            width: 100%;
        }

        body {
            font-family: 'Roboto', sans-serif;
            color: #f2f2f2;
            /* Set background image */
            background-image: url('background.png');
            
            /* Set background size to cover the entire viewport */
            background-size: cover;

            /* Set background repeat to no-repeat */
            background-repeat: no-repeat;

            /* Set background position to center center */
            background-position: center center;

            /* Set minimum height to cover the entire viewport */
            min-height: 100vh;

         

        }

        .login {

    background-color: #3498db; /* Blue background color */
    color: white;
    text-decoration: none;
    padding: 12px 18px; /* Adjust padding as needed */
    display: inline-block;
    border-radius: 5px; /* Rounded edges */
    margin-left: 1%;

        }


        .reg{
            border: 2px solid white; 
    border-radius: 10px;
    padding: 10px 16px; /* Adjust padding as needed */
    display: inline-block;

        }


        input[type=text], select {
  width: 100%;
  padding: 12px 20px;
  margin: 8px 0;
  display: inline-block;
  border: 1px solid #ccc;
  border-radius: 4px;
  box-sizing: border-box;
}

input[type=submit] {
  width: 100%;
  background-color: #3498db;
  color: white;
  padding: 14px 20px;
  margin: 8px 0;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

input[type=submit]:hover {
    color: rgb(255, 251, 0);
}

div {
  border-radius: 5px;
  /* background-color: #f2f2f2; */
  
  width: 50%;
  position: absolute;
  
  left: 25%;


}

.info{

    position:relative; top:120px;
}


    </style>
</head>
<body >

  
        
    <header>
        
        <nav>
            
            <a href="index.php">Home</a>
            <a href="about.php">About</a>
            <a href="services.php">Services</a>
            <a href="contact.php">Contact</a>
          
        </nav>
        
    </header>
        
    

   
      <div class="info">

            <?php


    echo "<h2 style='text-align: center;color:red'>$message</h2>";

?>

      </div>
    

</body>
</html>