<?php

$banner = $_POST["banner"];

function read_descriptions_from_csv($csv_filename, $banner) {
    $descriptions = [];
    
    // Read the CSV file and create a list of descriptions containing the banner keyword
    if (($handle = fopen($csv_filename, "r")) !== FALSE) {
        while (($row = fgetcsv($handle, 1000, ",")) !== FALSE) {
            if (count($row) >= 3) {
                $description = $row[2];
                if (stripos($description, $banner) !== false) {
                    $descriptions[] = $description;
                }
            }
        }
        fclose($handle);
    }

    return $descriptions;
}

function compare_banner_to_descriptions($banner, $descriptions) {
    if (!empty($descriptions)) {
        echo "Banner '{$banner}' closely matches description(s):" . PHP_EOL;
        foreach ($descriptions as $description) {
            echo "- '{$description}'" . PHP_EOL;
        }
    } else {
        echo "No close match found for banner '{$banner}'" . PHP_EOL;
    }
}

// Example CSV filename
$csv_filename = 'exploitdb_csv.csv';  // Assuming the CSV file is named exploitdb_csv.csv

// Example banner

// $banner = 'PHP Blue Dragon CMS 2.9.1';  

// Read descriptions from CSV based on the banner keyword
$descriptions = read_descriptions_from_csv($csv_filename, $banner);

// Compare banner to descriptions
compare_banner_to_descriptions($banner, $descriptions);

?>
